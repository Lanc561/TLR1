#include <iostream>
#include "TableRouteCipher.h"

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
void testCipher() {
    std::cout << "\n=== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –û–ë–†–ê–ë–û–¢–ö–ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–ô ===" << std::endl;
    
    // –¢–ï–°–¢ 1: –ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π - —Ç–µ–∫—Å—Ç –ë–û–õ–¨–®–ï –∫–ª—é—á–∞ (–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å)
    std::cout << "\n--- –¢–ï–°–¢ 1: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ---" << std::endl;
    std::cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: –¢–µ–∫—Å—Ç 'HELLO' (5 —Å–∏–º–≤–æ–ª–æ–≤) > –ö–ª—é—á 3" << std::endl;
    std::cout << "–û–∂–∏–¥–∞–Ω–∏–µ: –£–°–ü–ï–®–ù–û–ï —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ" << std::endl;
    try {
        TableRouteCipher cipher1(3);
        std::string encrypted = cipher1.encrypt("HELLO");
        std::string decrypted = cipher1.decrypt(encrypted);
        std::cout << "‚úì –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù" << std::endl;
        std::cout << "  –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ: " << encrypted << std::endl;
        std::cout << "  –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ: " << decrypted << std::endl;
    } catch (const cipher_error& e) {
        std::cout << "‚úó –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù - " << e.what() << std::endl;
    }
    
    // –¢–ï–°–¢ 2: –¢–µ–∫—Å—Ç –†–ê–í–ï–ù –∫–ª—é—á—É (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
    std::cout << "\n--- –¢–ï–°–¢ 2: –¢–µ–∫—Å—Ç —Ä–∞–≤–µ–Ω –∫–ª—é—á—É ---" << std::endl;
    std::cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: –¢–µ–∫—Å—Ç 'WORLD' (5 —Å–∏–º–≤–æ–ª–æ–≤) = –ö–ª—é—á 5" << std::endl;
    std::cout << "–û–∂–∏–¥–∞–Ω–∏–µ: –û–®–ò–ë–ö–ê '–î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ –∫–ª—é—á–∞'" << std::endl;
    try {
        TableRouteCipher cipher2(5);
        cipher2.encrypt("WORLD");
        std::cout << "‚úó –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù - –û–∂–∏–¥–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞" << std::endl;
    } catch (const cipher_error& e) {
        std::cout << "‚úì –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù - " << e.what() << std::endl;
    }
    
    // –¢–ï–°–¢ 3: –¢–µ–∫—Å—Ç –ú–ï–ù–¨–®–ï –∫–ª—é—á–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
    std::cout << "\n--- –¢–ï–°–¢ 3: –¢–µ–∫—Å—Ç –º–µ–Ω—å—à–µ –∫–ª—é—á–∞ ---" << std::endl;
    std::cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: –¢–µ–∫—Å—Ç 'HI' (2 —Å–∏–º–≤–æ–ª–∞) < –ö–ª—é—á 10" << std::endl;
    std::cout << "–û–∂–∏–¥–∞–Ω–∏–µ: –û–®–ò–ë–ö–ê '–î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ –∫–ª—é—á–∞'" << std::endl;
    try {
        TableRouteCipher cipher3(10);
        cipher3.encrypt("HI");
        std::cout << "‚úó –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù - –û–∂–∏–¥–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞" << std::endl;
    } catch (const cipher_error& e) {
        std::cout << "‚úì –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù - " << e.what() << std::endl;
    }
    
    // –¢–ï–°–¢ 4: –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –∫–ª—é—á (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
    std::cout << "\n--- –¢–ï–°–¢ 4: –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –∫–ª—é—á ---" << std::endl;
    std::cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: –ö–ª—é—á = 0 (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∏–ª–∏ –Ω—É–ª–µ–≤–æ–π)" << std::endl;
    std::cout << "–û–∂–∏–¥–∞–Ω–∏–µ: –û–®–ò–ë–ö–ê '–ö–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º'" << std::endl;
    try {
        TableRouteCipher cipher4(0);
        std::cout << "‚úó –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù - –û–∂–∏–¥–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞" << std::endl;
    } catch (const cipher_error& e) {
        std::cout << "‚úì –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù - " << e.what() << std::endl;
    }
    
    // –¢–ï–°–¢ 5: –¢–µ–∫—Å—Ç –±–µ–∑ –±—É–∫–≤–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
    std::cout << "\n--- –¢–ï–°–¢ 5: –¢–µ–∫—Å—Ç –±–µ–∑ –±—É–∫–≤ ---" << std::endl;
    std::cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: –¢–µ–∫—Å—Ç '12345' (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã, –Ω–µ—Ç –±—É–∫–≤)" << std::endl;
    std::cout << "–û–∂–∏–¥–∞–Ω–∏–µ: –û–®–ò–ë–ö–ê '–¢–µ–∫—Å—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±—É–∫–≤'" << std::endl;
    try {
        TableRouteCipher cipher5(3);
        cipher5.encrypt("12345");
        std::cout << "‚úó –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù - –û–∂–∏–¥–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞" << std::endl;
    } catch (const cipher_error& e) {
        std::cout << "‚úì –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù - " << e.what() << std::endl;
    }
    
    // –¢–ï–°–¢ 6: –ü—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
    std::cout << "\n--- –¢–ï–°–¢ 6: –ü—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç ---" << std::endl;
    std::cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: –¢–µ–∫—Å—Ç '' (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)" << std::endl;
    std::cout << "–û–∂–∏–¥–∞–Ω–∏–µ: –û–®–ò–ë–ö–ê '–¢–µ–∫—Å—Ç –ø—É—Å—Ç'" << std::endl;
    try {
        TableRouteCipher cipher6(3);
        cipher6.encrypt("");
        std::cout << "‚úó –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù - –û–∂–∏–¥–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞" << std::endl;
    } catch (const cipher_error& e) {
        std::cout << "‚úì –†–ï–ó–£–õ–¨–¢–ê–¢: –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù - " << e.what() << std::endl;
    }
}

int main()
{
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
    testCipher();
    
    std::cout << "\n=== –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –†–ï–ñ–ò–ú ===" << std::endl;
    std::cout << "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é:" << std::endl;
    
    try {
        int key;
        std::cout << "–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á (—á–∏—Å–ª–æ —Å—Ç–æ–ª–±—Ü–æ–≤): ";
        std::cin >> key;

        TableRouteCipher cipher(key); 

        int op;
        std::string text;
        do {
            std::cout << "\n–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—é:\n";
            std::cout << "1 ‚Äî –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç\n";
            std::cout << "2 ‚Äî –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç\n";
            std::cout << "0 ‚Äî –í—ã—Ö–æ–¥\n";
            std::cout << "–í–∞—à –≤—ã–±–æ—Ä: ";
            std::cin >> op;

            if (op == 1 || op == 2) {
                std::cout << "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç: ";
                std::cin.ignore();
                std::getline(std::cin, text);

                try {
                    if (op == 1) {
                        std::string encrypted = cipher.encrypt(text);
                        std::cout << "üîí –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç: " << encrypted << "\n";
                    } else if (op == 2) {
                        std::string decrypted = cipher.decrypt(text);
                        std::cout << "üîì –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç: " << decrypted << "\n";
                    }
                } catch (const cipher_error& e) {
                    std::cout << "‚ùå –û—à–∏–±–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: " << e.what() << "\n";
                    std::cout << "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ë–û–õ–¨–®–ï –∫–ª—é—á–∞ (" << key << ")" << "\n";
                } catch (const std::exception& e) {
                    std::cout << "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: " << e.what() << "\n";
                }
            } else if (op != 0) {
                std::cout << "‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\n";
            }

        } while (op != 0);

        std::cout << "üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!\n";

    } catch (const cipher_error& e) {
        std::cerr << "‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: " << e.what() << std::endl;
        return 1;
    } catch (const std::exception& e) {
        std::cerr << "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: " << e.what() << std::endl;
        return 1;
    }

    return 0;
}
